container_commands:
  00_python_path:
    command: "echo 'export PYTHONPATH=/var/app/current:$PYTHONPATH' >> /opt/elasticbeanstalk/deployment/env"
  01_migrate:
    command: |
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      python -c "import sys; print(sys.path)"
      python manage.py showmigrations
      python manage.py migrate --noinput
    leader_only: true
    ignoreErrors: false
  02_collectstatic:
    command: |
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      python manage.py collectstatic --noinput